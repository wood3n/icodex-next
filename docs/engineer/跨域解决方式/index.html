<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-engineer/跨域解决方式">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">跨域与解决方案 | icodex</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://icodex.me/docs/engineer/跨域解决方式"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="keywords" content="frontend, react, javascript, css, react, vue, typescript, docusaurus, blog, personal blog, personal website"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="跨域与解决方案 | icodex"><meta data-rh="true" name="description" content="同源的定义"><meta data-rh="true" property="og:description" content="同源的定义"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://icodex.me/docs/engineer/跨域解决方式"><link data-rh="true" rel="alternate" href="https://icodex.me/docs/engineer/跨域解决方式" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://icodex.me/docs/engineer/跨域解决方式" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GMKEEJO8X4-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="icodex RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="icodex Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153188913-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-153188913-1",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="icodex" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.596c1d98.css">
<link rel="preload" href="/assets/js/runtime~main.37c10f68.js" as="script">
<link rel="preload" href="/assets/js/main.777d231b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="icodex" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="icodex" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">icodex</b></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><a class="navbar__item navbar__link" href="/pages/project">My Project</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Skill</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/javascript/guides">JavaScript</a></li><li><a class="dropdown__link" href="/docs/css/guides">CSS</a></li><li><a class="dropdown__link" href="/docs/typescript">TypeScript</a></li><li><a class="dropdown__link" href="/docs/react/guides">React</a></li><li><a class="dropdown__link" href="/docs/nodejs/awesome-nodejs">NodeJS</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/network/guides">Network</a></li><li><a class="dropdown__link" href="/docs/algorithm/算法分析">Algorithm</a></li><li><a class="dropdown__link" href="/docs/interview/guides">Interview</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/engineer/guides">Engineer</a><a class="navbar__item navbar__link" href="/docs/tools/git">Tool</a><a href="https://github.com/wood3n/icodex-next" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.png" alt="icodex" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="icodex" class="themedImage_ToTc themedImage--dark_i4oU"><b>icodex</b></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/engineer/guides">前端工程化体系</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/Babel/babel plugin编写">Babel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/electron1">electron</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/engineer/git hooks">git hooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/engineer/guides">目录</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/eslintconfig">linter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/rollupplugin1">roolup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/viteplugin1">vite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/vscode插件开发/vsex1">vscode插件开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/webpack5">webpack5配置</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/webpack优化/webpack优化（1）">webpack优化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/webpackloader">webpack原理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/enhancedweb1">web性能优化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/使用yeoman搭建脚手架/脚手架搭建（1）">使用yeoman搭建脚手架</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/图标库搭建/svg">图标库搭建</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/基于webpack搭建react项目/搭建React项目（1）">基于webpack搭建react项目</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/engineer/模块语法/CSS模块语法">模块语法</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/engineer/跨域解决方式">跨域与解决方案</a></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/engineer/guides"><span itemprop="name">前端工程化体系</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">跨域与解决方案</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>同源策略</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="同源的定义">同源的定义<a class="hash-link" href="#同源的定义" title="标题的直接链接">​</a></h2><p>同源：<strong>协议，域名/ip，端口号</strong>三者全部相同，注意一般情况下省略端口号都是默认<code>80</code>端口的情况。在页面中通过<code>javascript:</code>方式打开的页面会继承当前 URL 的源。</p><ul><li>限制子域名不属于同源的，例如 mail.google.com 和 docs.google.com；</li><li>限制不同端口的不属于同源，例如 google.com 和 google.com:8080</li></ul><p><img loading="lazy" alt="image-20200731214020188" src="/assets/images/image-20200731214020188-1596961661065-c5e0d4149912c0e0ab61a57c4a47c6a6.png" width="1209" height="339" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="同站的定义">同站的定义<a class="hash-link" href="#同站的定义" title="标题的直接链接">​</a></h2><p>为了下文内容的完整性，这里再单独介绍下一个容易和同源搞混淆的概念：同站。</p><p>同站只看域名部分，但也分为两种情况：</p><ol><li>对于在<a href="https://web.dev/i18n/zh/same-site-same-origin/" target="_blank" rel="noopener noreferrer">现有顶级域名列表</a>下的二级域名相同，即可认为是同站，例如<code>.com</code>和<code>.org</code>这些顶级域，其和子域名也看做同站：<code>example.com</code>和<code>xxx.example.com</code></li><li>对于在<a href="https://publicsuffix.org/list/public_suffix_list.dat" target="_blank" rel="noopener noreferrer">公共后缀列表</a>下的域名，需要保证其下子域名相同，例如<code>.co.jp</code>或 <code>.github.io</code>这些，需要再往前看一层子域名是否相同，<code>your-project.github.io</code>和<code>my-project.github.io</code>就不是同站</li></ol><p>但是 Chrome 对于同站<a href="https://web.dev/samesite-cookies-explained/" target="_blank" rel="noopener noreferrer">有自己的定义</a>，它会把请求 URL 的<strong>协议</strong>也算在内，也就是<code>http</code>和<code>https</code>就不是同站。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="不受同源策略限制的情景">不受同源策略限制的情景<a class="hash-link" href="#不受同源策略限制的情景" title="标题的直接链接">​</a></h2><p>同源策略并不是严格限制所有网页请求资源的加载，一般情况对以下请求是被允许的：</p><ul><li><p>通过<code>script</code>，<code>img</code>，<code>video</code>，<code>audio</code>，<code>iframe</code>元素的<code>src</code>属性发起的请求；</p></li><li><p>通过<code>link</code>元素的<code>href</code>属性发起的请求；</p></li><li><p>通过<code>object</code>元素的<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/object#attr-data" target="_blank" rel="noopener noreferrer"><code>data</code>属性</a>发起的请求；</p></li><li><p>在 CSS 中通过<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/image" target="_blank" rel="noopener noreferrer"><code>image</code></a>数据类型发起的请求，例如：</p><ul><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/url" target="_blank" rel="noopener noreferrer"><code>url()</code>函数</a>；</p></li><li><p><code>image()</code>函数；</p></li><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/image/image-set" target="_blank" rel="noopener noreferrer"><code>image-set()</code>函数</a></p></li></ul></li><li><p>通过<code>form</code>元素的<code>action</code>属性指定的请求</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="受到同源策略限制的情景">受到同源策略限制的情景<a class="hash-link" href="#受到同源策略限制的情景" title="标题的直接链接">​</a></h2><p>跨域请求资源的读操作通常是被限制的，通常来说跨域请求能够发出，但是收到的响应会被浏览器丢弃，并以错误提醒的方式抛出。</p><ul><li>禁止页面内部的 JS 通过<a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/contentWindow" target="_blank" rel="noopener noreferrer"><code>iframe.contentWindow</code></a>读取页面内部嵌入的<code>iframe</code>的内容；为了能让不同源中文档进行交流，可以使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage" target="_blank" rel="noopener noreferrer"><code>window.postMessage</code></a></li><li>禁止读取<code>image</code>，<code>video</code>，<code>audio</code>等多媒体元素的数据，例如<code>canvas</code>绘制的场景</li><li>禁止读取<code>XMLHttpRequest</code>或者<code>fetch</code>发起的跨域请求的响应内容</li><li>禁止访问不同源的<code>sessionStorage</code>，<code>localStorage</code>和<code>IndexDB</code>存储的内容</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cookie-的限制">cookie 的限制<a class="hash-link" href="#cookie-的限制" title="标题的直接链接">​</a></h2><p>cookie 的限制其实不是同源还是同站限制，稍微宽泛一点。</p><p>首先服务端可以通过<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie" target="_blank" rel="noopener noreferrer"><code>Set-Cookie</code>响应头</a>以键值对<code>key=Value</code>的方式来设置客户端的 cookie</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>除了设置 cookie 的值，还可以在 cookie 值的后面追加以下几个限制 cookie 的属性：</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Secure; HttpOnly</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><code>Expires=&lt;date&gt;</code>：指定 cookie 的清除截止时间，一个 UTC 时间，使用 <a href="https://icodex.me/docs/javascript/Date/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%97%B6%E9%97%B4%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95#iso-8601" target="_blank" rel="noopener noreferrer">iso8601 时间格式</a>，例如<code>2023-07-18T15:57:26.671Z</code></p></li><li><p><code>Max-Age=&lt;number&gt;</code>：指定 cookie 过期前的秒数，设置为 0 或者负数会使浏览器清除 cookie，优先级高于<code>Expires</code></p></li><li><p><code>Domain=&lt;domain-value&gt;</code>：指定一个发送 HTTP 请求时携带 cookie 的域名，如果不指定的话就默认为当前域名，但是不包括子域名；而如果明确指定了一个域名，请求其子域名时，cookie 也会始终携带上；现代浏览器一般行为与早期规范相反，指定域名 (.example.com) 的前导点会被忽略，也就是包含当前域和其子域</p></li><li><p><code>Path=&lt;path-value&gt;</code>：指定发送 HTTP 请求时携带 cookie 的 URL 中必须包含的<code>pathname</code>部分：</p><ul><li>如果指定<code>/</code>，则所有子路径都会包含在内；</li><li>如果指定<code>/sub</code>，则所有以<code>/sub</code>开头的子路径也都匹配在内</li></ul></li><li><p><code>Secure</code>：指定携带 cookie 时请求 URL 协议必须是<code>https</code>或者<code>localhost</code></p></li><li><p><code>HttpOnly</code>：指定 cookie 只能用于 HTTP 传输，不能被 JS 等脚本读取，防止 XSS（跨站脚本攻击）</p></li><li><p><code>SameSite=&lt;samesite-value&gt;</code>：指定发送不同站请求时是否携带 cookie，主要为了防范 CSRF（跨站请求伪造）攻击，<code>SameSite</code>的值可以有以下几种：</p><ul><li><p><code>Lax</code>：默认值，网页内部的跨站资源请求（例如<code>img</code>元素等）不会携带 cookie，但是通过导航链接<code>a</code>元素跳转到其他站点时会携带<code>cookie</code></p></li><li><p><code>Strict</code>：cookie 只在同站请求时发送</p></li><li><p><code>None</code>：cookie 总是在请求的时候携带上，同时必须指定<code>Secure</code>属性，进一步限制 HTTPS 的安全性</p></li></ul></li></ul><p>到目前为止，指定<code>SameSite:None</code>时必须指定<code>Secure</code>的行为在浏览器之间仍不一致，只有 chromium 内核的浏览器支持：</p><p><img loading="lazy" alt="image-20220719221610011" src="/assets/images/image-20220719221610011-e50778160f30610ba6497e14f3d98710.png" width="1689" height="497" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="好处">好处<a class="hash-link" href="#好处" title="标题的直接链接">​</a></h2><p>同源策略的最大好处是使得网页请求变得更加安全：</p><ul><li>可以阻止网页恶意脚本，尤其是基于<code>cookie</code>的身份验证和授权机制，现在绝大部分网站仍然使用这种方式来进行用户身份的识别。设想一下，假设一个用户正在访问银行网站且未注销。然后，用户转到另一个站点，该站点的某些恶意 JavaScript 代码在后台运行，并试图通过 DOM API 或者<code>document.cookie</code>来获取银行网页中的数据。这是来自一个不同源网页脚本的攻击行为，有了浏览器的同源策略就能轻易组织它。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="不足">不足<a class="hash-link" href="#不足" title="标题的直接链接">​</a></h2><ul><li>同源策略无法阻止跨站伪造请求（CSRF）和点击劫持之类的攻击。</li><li>同源策略给前端本地开发带来麻烦，本地服务器打开的页面访问服务器资源时就会受到限制。</li></ul><h1>CORS</h1><p>CORS，Cross-Origin Resource Sharing，跨域资源共享是 W3C 针对跨源资源请求制定的标准方案，也是目前跨域请求主流的解决方案。</p><p>由于浏览器的同源策略限制，在页面 JS 中使用<code>XMLHttpRequest</code>和<code>Fetch API</code>时只能请求同源的 URL，CORS 则允许通过特定 HTTP 请求头和响应头参数来允许<code>XMLHttpRequest</code>和<code>Fetch API</code>执行跨源请求。</p><p>现在主流浏览器基本都支持 CORS，只要服务端配置以下响应头部就可以顺利实现跨域资源请求，有一个网站叫<a href="https://enable-cors.org/index.html" target="_blank" rel="noopener noreferrer">Enable CORS</a>，介绍了诸多服务端实现的方法，例如 <a href="https://enable-cors.org/server_nginx.html" target="_blank" rel="noopener noreferrer">nginx 的配置项</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简单请求">简单请求<a class="hash-link" href="#简单请求" title="标题的直接链接">​</a></h2><p>浏览器会将跨域请求分为简单请求和非简单请求。</p><p>在简单请求中，浏览器会根据<code>XMLHttpRequest</code>的请求自动添加<code>Origin</code>请求头参数，在发出请求并获取响应之后，会根据响应头部的<code>Access-Control-Allow-Origin</code>字段判断当前域是否在服务器允许跨域请求的范围之内。因此要想允许跨域请求，只需要服务端设置响应头参数<code>Access-Control-Allow-Origin</code>即可。</p><blockquote><p>请求头部自动添加</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Origin: http://foo.example</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><blockquote><p>响应头需要服务器手动添加</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Origin: http://foo.example</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>简单请求只需要两步即可收到响应：</p><ul><li>浏览器添加<code>Origin</code>头部信息，发送请求；</li><li>服务器返回响应头<code>Access-Control-Allow-Origin</code>，<strong>浏览器收到后判断是否允许跨域请求，不允许则报错</strong></li></ul><p><img loading="lazy" alt="image-20200802001326853" src="/assets/images/image-20200802001326853-a4bbdea36b3155c995e3abda94848294.png" width="997" height="484" class="img_ev3q"></p><p><strong>简单请求</strong>必须满足以下所有条件：</p><ul><li><p>使用<code>GET</code>，<code>HEAD</code>或<code>POST</code>请求</p></li><li><p>只允许以下<code>Content-Type</code>值</p><ul><li><code>application/x-www-form-urlencoded</code></li><li><code>multipart/form-data</code></li><li><code>text/plain</code>：纯文本字符串</li></ul></li><li><p>除了使用用户代理自动设置的头部字段，只允许手动设置以下头部参数</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept" target="_blank" rel="noopener noreferrer"><code>Accept</code></a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language" target="_blank" rel="noopener noreferrer"><code>Accept-Language</code></a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Language" target="_blank" rel="noopener noreferrer"><code>Content-Language</code></a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type" target="_blank" rel="noopener noreferrer"><code>Content-Type</code></a> (but note the additional requirements below)</li><li><code>DPR</code></li><li><code>Downlink</code></li><li><code>Save-Data</code></li><li><code>Viewport-Width</code></li><li><code>Width</code></li></ul></li><li><p>没有在请求中使用的任何<code>XMLHttpRequestUpload</code>对象上注册事件侦听器</p></li><li><p>请求中未使用<a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream" target="_blank" rel="noopener noreferrer"><code>ReadableStream</code></a> 对象</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="非简单请求">非简单请求<a class="hash-link" href="#非简单请求" title="标题的直接链接">​</a></h2><p><strong>非简单请求</strong>就是不符合简单请求必须满足的所有条件，非简单请求一般是以下任一情况：</p><ul><li><code>PUT</code>，<code>DELETE</code>等方法</li><li>常用的<code>Content-Type</code>：<ul><li><code>application/json</code></li><li><code>text/xml</code></li></ul></li></ul><p>非简单请求发起时，浏览器会先使用<code>OPTIONS</code>方法发起一个<strong>预检请求</strong>到服务器，根据服务器返回的响应头部<code>Access-Control-Allow-Origin</code>以获知服务器是否允许该请求。</p><blockquote><p>预检请求头额外参数</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Origin: http://foo.example</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Request-Method: POST</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Request-Headers: X-PINGOTHER, Content-Type</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>在这个预检请求头参数中，<code>Access-Control-Request-Method</code>参数告知服务器在下一次发送时将使用<code>POST</code>请求，<code>Access-Control-Request-Headers</code>表示正是请求还将携带两个自定义的请求字段：X-PINGOTHER 和 Content-Type</p><blockquote><p>预检请求体额外参数</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Origin: http://foo.example</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Methods: POST, GET, OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Headers: X-PINGOTHER, Content-Type</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Max-Age: </span><span class="token number">86400</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>服务器在收到预检请求后，肯定会发送一个<code>Access-Control-Allow-Origin</code>头部字段来告知浏览器，只有该参数的值允许跨域请求；如果服务器允许发送请求，对应请求时发送的<code>Access-Control-Request-Method</code>字段，服务端还会回应<code>Access-Control-Allow-Methods</code>字段，表示允许使用的请求方法；<code>Access-Control-Allow-Headers</code>对应于请求时<code>Access-Control-Request-Headers</code>字段，表示允许请求时发送的额外头部字段。</p><p>此外浏览器还会根据<code>Access-Control-Max-Age:86400</code>表明该响应的有效时间为 86400 秒，也就是 24 小时之内，浏览器无须为同一请求再次发起预检请求。值得注意的是，不同浏览器对于这个时间的上限要求不同：</p><ul><li>FireFox 是最大 24 小时，也就是 86400 秒</li><li>而 Chrome 在 V76 以后，最大值允许 2 小时，7200 秒</li><li>如果值是<code>-1</code>，表示不允许缓存该预检请求，每次请求都必须先预检</li></ul><p>非简单请求由于需要发送预检请求的原因，一般需要三次握手才能获取最终的响应结果：</p><ul><li>浏览器判断是非简单请求，使用<code>OPTIONS</code>发送预检请求；服务端收到预检请求，返回响应；</li><li>浏览器判断服务端是否允许发送正式请求，允许使用允许的请求方法和头部发送正式请求；</li><li>服务端收到正式请求，返回响应；浏览器接收响应</li></ul><p><img loading="lazy" alt="preflight_correct" src="/assets/images/preflight_correct-58b647f7e01009a1c9b73b53eef74203.png" width="521" height="553" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="附带身份凭证的请求">附带身份凭证的请求<a class="hash-link" href="#附带身份凭证的请求" title="标题的直接链接">​</a></h2><p>一般而言，对于<code>XMLHttpRequest</code>和<code>Fetch</code>，受到同源策略的限制，浏览器不会在跨域请求时发送当前页面的<code>cookie</code>等身份凭证信息，但是<code>XMLHttpRequest</code>支持<code>withCredentials</code>属性，将该属性设置为<code>withCredential = true</code>，则表示该请求会发送<code>cookie</code>，HTTP Basic authentication，或者客户端 SSL 证明等信息。</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> ajax </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">XMLHttpRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">invocation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ajax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;GET&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ajax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">withCredentials</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ajax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">send</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果服务器接受请求的凭据，会在响应头中添加：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Credentials: </span><span class="token boolean">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>而如果响应头中没有<code>Access-Control-Allow-Credentials: true</code>，浏览器将不会把响应内容返回给请求的发送者，在<code>XMLHttpRequest</code>收到响应后，<code>requestText</code>将是空字符串，<code>status</code>值为<code>0</code>，而且会调用<code>onerror()</code>事件处理程序。</p><p>另外，对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin</code> 的值为“<code>*</code>”。这是因为请求的首部中携带了 <code>Cookie</code> 信息，如果 <code>Access-Control-Allow-Origin</code> 的值为“<code>*</code>”，请求将会失败。而将 <code>Access-Control-Allow-Origin</code> 的值设置为指定的请求域名如 <code>http://foo.example.com</code>，则请求将成功执行。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cors-headers">CORS headers<a class="hash-link" href="#cors-headers" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control-allow-origin">Access-Control-Allow-Origin<a class="hash-link" href="#access-control-allow-origin" title="标题的直接链接">​</a></h3><p><code>Access-Control-Allow-Origin</code>属于最常见的响应头参数，用于指定一个不同源的域名列表被允许访问资源，或者直接使用通配符<code>*</code>来标识允许所有不同源域名访问。</p><p>服务器会获取 HTTP 请求头字段<code>Origin</code>进行对比，允许则会将<code>Access-Control-Allow-Origin</code>设置成和<code>Origin</code>相同的值并返回。</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Origin: https://foo.bar.org</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Origin: *</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control-allow-headers">Access-Control-Allow-Headers<a class="hash-link" href="#access-control-allow-headers" title="标题的直接链接">​</a></h3><p>对于在预检请求时发送了<code>Access-Control-Request-Headers</code>请求头时，必须使用<code>Access-Control-Allow-Headers</code>响应头来标识允许客户端在访问资源时携带的 HTTP 请求头字段，支持自定义请求头字段。</p><p>如果<code>Access-Control-Allow-Headers</code>指定了通配符<code>*</code>，则表示允许访问资源时携带任意请求头（除了<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization" target="_blank" rel="noopener noreferrer"><code>Authorization</code></a>，<code>Authorization</code>必须严格在<code>Access-Control-Allow-Headers</code>标示出来）。</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Request-Headers: Content-Type, x-requested-with</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Headers: Content-Type, x-requested-with</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control-allow-credentials">Access-Control-Allow-Credentials<a class="hash-link" href="#access-control-allow-credentials" title="标题的直接链接">​</a></h3><p><code>Access-Control-Allow-Credentials</code>配合<code>XMLHttpRequest.withCredentials</code>或<code>fetch</code>的请求参数<code>Request.credentials</code>来使用，也就是选择在跨域请求时携带<code>cookie</code>，<code>Authorization</code>请求头或者TLS 客户端证书等身份凭据。</p><p>其分为两种情况：</p><ul><li>简单请求，通过以上两个设置会在跨域请求时携带<code>cookie</code>，如果服务端响应头为<code>Access-Control-Allow-Credentials:true</code>，则浏览器会把 HTTP 响应内容返回给请求方法，否则直接丢弃响应；</li><li>对于发送预检请求<code>Options</code>的情况，预检请求响应头必须为<code>Access-Control-Allow-Credentials:true</code>，后续请求才会继续发送。</li></ul><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Credentials: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control-allow-methods">Access-Control-Allow-Methods<a class="hash-link" href="#access-control-allow-methods" title="标题的直接链接">​</a></h3><p>用于预检请求，当预检请求携带<code>Access-Control-Request-Method</code>请求头时，服务端可通过<code>Access-Control-Allow-Methods</code>响应头指定允许的 HTTP 请求方法。</p><p>如果<code>Access-Control-Allow-Methods</code>设置成通配符<code>*</code>，如果请求没有携带任何<code>cookie</code>或者 HTTP 认证请求头<code>Authentication</code>，则表示允许任何请求方法；如果携带了身份凭据，<code>*</code>没有意义。</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Request-Method: POST</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Methods: POST, GET, OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Allow-Methods: *</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control-expose-headers">Access-Control-Expose-Headers<a class="hash-link" href="#access-control-expose-headers" title="标题的直接链接">​</a></h3><p><code>Access-Control-Expose-Headers</code>指定允许浏览器暴露给<code>js</code>等静态资源使用的响应头。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control-max-age">Access-Control-Max-Age<a class="hash-link" href="#access-control-max-age" title="标题的直接链接">​</a></h3><p><code>Access-Control-Max-Age</code>指定浏览器缓存预检请求结果的最长时间，以秒为单位。</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Access-Control-Max-Age: 600 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cors-的一些缺陷">CORS 的一些缺陷<a class="hash-link" href="#cors-的一些缺陷" title="标题的直接链接">​</a></h2><p>从 CORS 的机制了解到，在浏览器执行非简单请求时将会发送预检请求，等到服务端验证通过才去发送正式请求，这样的请求方式无端的多了一次建立连接的请求开销，对于大量并发的请求时，这种开销就会增加服务器的压力，可以从两方面进行优化：</p><ul><li>尽量只发送简单请求，使用<code>GET</code>，<code>POST</code>方法的同时不要去设置额外的请求头部，同时发送的<code>Content-Type</code>不能使用<code>application/json</code>，可以使用<code>text/plain</code>让后端解析；</li><li>让服务端在响应头添加<code>Access-Control-Max-Age</code>参数，来缓存预检结果，避免每次请求都会先发送预检请求</li></ul><h1>JSONP</h1><p>JSONP，JSON with Padding，填充式 JSON，也是跨域资源请求的一种方式。</p><p>JSONP 的原理就是<strong>利用<code>script</code>标签的<code>src</code>属性可以跨域载入资源，通过服务端返回的 JS 脚本来执行预先设置好的回调函数。</strong></p><p>JSONP 实现的方式是：</p><ul><li>利用 DOM 接口<code>createElement</code>动态创建一个<code>script</code>标签；</li><li>将<code>script</code>的<code>src</code>属性设置成服务器的请求地址，并在后面串接一个回调函数；</li><li>当服务器收到请求后，会解析请求发送的回调函数的名称，服务端在允许的情况下可以返回一串文本，形式大致就是<code>functionName({...数据})</code>，一个由回调函数名称和 JSON 数据组成的字符串；后端可以先获取查询数据，然后再和回调函数名称拼接字符串即可；</li><li>由于是<code>&lt;script&gt;</code>元素请求的脚本，浏览器在收到服务端返回的脚本内容以后，会把它当成 JS 去执行，也就达到了获取跨域获取数据的目的</li></ul><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&lt;</span><span class="token plain">script</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  var script </span><span class="token operator">=</span><span class="token plain"> document.createElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;script&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    script.src </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://www.example.com/path1?callback=handleResponse&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  document.body.insertBefore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">script, document.body.firstChild</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> handleResponse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">jsonResponse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //jsonResponse就是响应数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token plain">/script</span><span class="token operator">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="image-20200802120029159" src="/assets/images/image-20200802120029159-a41540dd9d173713056ce3ec79834ec1.png" width="567" height="548" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="第三方实现">第三方实现<a class="hash-link" href="#第三方实现" title="标题的直接链接">​</a></h2><p>jQuery.ajax 在 1.5 版本以后，支持 jsonp 跨域请求设置，ajax 里面可以通过<code>dataType</code>， <code>jsonp</code>，<code>jsonpCallback</code>等参数来设置 jsonp 请求，这里只能指定请求方法为<code>GET</code>，就算指定成 POST 方式，会自动转为 GET 方式。</p><blockquote><p><a href="https://api.jquery.com/jquery.ajax/" target="_blank" rel="noopener noreferrer">https://api.jquery.com/jquery.ajax/</a></p></blockquote><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">ajax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">url</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">async</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">method</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;GET&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">dataType</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;jsonp&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">jsonpCallback</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;handleResponse&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(80, 250, 123)">success</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> result </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">stringify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>axios 需要安装第三方库<code>jsonp</code>才支持 jsonp 请求</p><blockquote><p><a href="https://github.com/axios/axios/blob/master/COOKBOOK.md#jsonp" target="_blank" rel="noopener noreferrer">https://github.com/axios/axios/blob/master/COOKBOOK.md#jsonp</a></p></blockquote><p>可以自行将 jsonp 请求基于 Promise 封装为一个异步函数进行调用，参见掘金的一个回答：</p><blockquote><p><a href="https://juejin.im/post/6844903992057659400#heading-1" target="_blank" rel="noopener noreferrer">https://juejin.im/post/6844903992057659400#heading-1</a></p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jsonp-的缺点">JSONP 的缺点<a class="hash-link" href="#jsonp-的缺点" title="标题的直接链接">​</a></h2><ul><li>JSONP 通过<code>script</code>标签请求服务器加载文件，因此<strong>只支持<code>GET</code>请求</strong>，如果要携带请求参数，只能将参数串接在 URL 后面，这样直接暴露数据的方式相对来说<strong>不安全</strong>，但也并不是说绝对不安全，实际上服务端仍然可以对请求去做验证；</li><li>同时 JSONP 的<strong>报错不是太明显</strong>，要确定 JSONP 是否请求失败，可以通过<code>script</code>的<code>onerror</code>事件来处理；或者使用定时器来定时检测是否收到响应；</li><li>JSONP 和 CORS 都需要服务端配合，在 CORS 兼容性已经很好的今天，推荐使用 CORS。</li></ul><h1>WebSockets</h1><blockquote><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" target="_blank" rel="noopener noreferrer">WebSocket API</a></p></blockquote><p>WebSockets，或者叫网络层套接字协议，它和 HTTP 一样，属于网络层的一种协议，并且建立在 TCP 连接基础上的，但是 WebSockets 最主要的功能是提供全双工双向通信，使得服务端可以向网页推送数据。</p><p>WebSockets 协议的原理和使用这里不做具体分析，<strong>WebSockets 协议能跨域请求的原理是使用单独的协议而不受浏览器的同源策略限制</strong>。</p><p>首先要明确一点，WebSockets 需要在 HTTP 报文的基础上建立连接，在创建一个 WebSockets 对象后，浏览器就会马上尝试创建连接，过程大致如下：</p><p>首次会通过发送 HTTP 报文的方式建立与服务器的 TCP 连接，然后再发送最后一个 HTTP 报文请求服务器切换到 WebSockets 的协议上来，服务器在收到请求后会发送<code>101</code>响应来表示成功切换到 WebSockets 协议上了。</p><p>你可能会疑惑，为什么通过 HTTP 请求建立 TCP 连接的时候不受浏览器的同源策略限制，实际上仍然会收到限制，但是浏览器会忽略这个限制，继续发送切换到 WebSockets 协议的请求建立 WebSockets 协议的连接，而只要建立了 WebSockets 协议的连接，就不是 HTTP 协议能管的事了。</p><blockquote><p>参考：<a href="https://blog.securityevaluators.com/websockets-not-bound-by-cors-does-this-mean-2e7819374acc" target="_blank" rel="noopener noreferrer">https://blog.securityevaluators.com/websockets-not-bound-by-cors-does-this-mean-2e7819374acc</a></p></blockquote><p>JS 建立 WebSockets 协议并接收数据只需两步：</p><ul><li>初始化一个 WebSocket 对象；</li><li>使用<code>onmessage</code>方法接收数据。</li></ul><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// Create WebSocket connection.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> socket </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">WebSocket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ws://localhost:8080&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Connection opened</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">addEventListener</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;open&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  socket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">send</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Hello Server!&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Listen for messages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">addEventListener</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;message&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Message from server &#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>代理服务器</h1><p>代理分为正向代理和反向代理。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="正向代理">正向代理<a class="hash-link" href="#正向代理" title="标题的直接链接">​</a></h2><p>正向代理就是代理客户端，日常最为常用，例如前端开发起的本地 Nodejs 服务器；</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// 现在，对 /api/users 的请求会将请求代理到 http://localhost:3000/api/users</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">devServer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">proxy</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string-property property">&#x27;/api&#x27;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;http://localhost:3000&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="反向代理">反向代理<a class="hash-link" href="#反向代理" title="标题的直接链接">​</a></h2><p>反向代理就是代理服务器，通过请求同源的服务端域名，通过反向代理配置等方式将请求转发至目的域名这样。</p><p><img loading="lazy" alt="image-20200802155714231" src="/assets/images/image-20200802155714231-4531abca18c78efd2e3e33416299fd86.png" width="673" height="381" class="img_ev3q"></p><p>例如<code>nginx</code>的反向代理，利用代理 nginx 服务器监听端口请求域名，然后根据匹配规则将请求转发到真正的目标处理服务器进行处理</p><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  listen       80;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  server_name  域名;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  root D:\build;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  location / {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header X-Forwarded-For $remote_addr;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_pass http://ip:port;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  location /apis {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rewrite  ^/apis/(.*)$ /api/v1/$1 break;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_pass   http://ip:port;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  location /imgs {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rewrite  ^/imgs/(.*)$ /$1 break;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_pass   http://ip:port;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  location /fontimgs {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rewrite  ^/fontimgs/(.*)$ /$1 break;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_pass   http://ip:port;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  error_page   500 502 503 504  /50x.html;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  location = /50x.html {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    root   html;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wood3n/icodex-next/tree/master/docs/engineer/跨域解决方式.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/engineer/模块语法/webpack模块语法"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">webpack模块语法</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#同源的定义" class="table-of-contents__link toc-highlight">同源的定义</a></li><li><a href="#同站的定义" class="table-of-contents__link toc-highlight">同站的定义</a></li><li><a href="#不受同源策略限制的情景" class="table-of-contents__link toc-highlight">不受同源策略限制的情景</a></li><li><a href="#受到同源策略限制的情景" class="table-of-contents__link toc-highlight">受到同源策略限制的情景</a></li><li><a href="#cookie-的限制" class="table-of-contents__link toc-highlight">cookie 的限制</a></li><li><a href="#好处" class="table-of-contents__link toc-highlight">好处</a></li><li><a href="#不足" class="table-of-contents__link toc-highlight">不足</a></li><li><a href="#简单请求" class="table-of-contents__link toc-highlight">简单请求</a></li><li><a href="#非简单请求" class="table-of-contents__link toc-highlight">非简单请求</a></li><li><a href="#附带身份凭证的请求" class="table-of-contents__link toc-highlight">附带身份凭证的请求</a></li><li><a href="#cors-headers" class="table-of-contents__link toc-highlight">CORS headers</a><ul><li><a href="#access-control-allow-origin" class="table-of-contents__link toc-highlight">Access-Control-Allow-Origin</a></li><li><a href="#access-control-allow-headers" class="table-of-contents__link toc-highlight">Access-Control-Allow-Headers</a></li><li><a href="#access-control-allow-credentials" class="table-of-contents__link toc-highlight">Access-Control-Allow-Credentials</a></li><li><a href="#access-control-allow-methods" class="table-of-contents__link toc-highlight">Access-Control-Allow-Methods</a></li><li><a href="#access-control-expose-headers" class="table-of-contents__link toc-highlight">Access-Control-Expose-Headers</a></li><li><a href="#access-control-max-age" class="table-of-contents__link toc-highlight">Access-Control-Max-Age</a></li></ul></li><li><a href="#cors-的一些缺陷" class="table-of-contents__link toc-highlight">CORS 的一些缺陷</a></li><li><a href="#第三方实现" class="table-of-contents__link toc-highlight">第三方实现</a></li><li><a href="#jsonp-的缺点" class="table-of-contents__link toc-highlight">JSONP 的缺点</a></li><li><a href="#正向代理" class="table-of-contents__link toc-highlight">正向代理</a></li><li><a href="#反向代理" class="table-of-contents__link toc-highlight">反向代理</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.37c10f68.js"></script>
<script src="/assets/js/main.777d231b.js"></script>
</body>
</html>