---
title: å¦‚ä½•å¼€å‘è‡ªå·±çš„ä¸€ä¸ª shadcn ç»„ä»¶
slug: /shadcn-component
authors: oxygen
---

è·ç¦»ä¸Šä¸€ç¯‡ä»‹ç»`shadcn`æ–‡ç« å·²è¿‡å»ä¸€å¹´ä¹‹ä¹…å•¦ğŸ˜…ã€‚åœ¨è¿™ä¸€å¹´å¤šçš„æ—¶é—´å†…ï¼Œéšç€`AI Generate Web`æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œ`shadcn`å‡­å€Ÿå…¶ AI å‹å¥½çš„ç»„ä»¶å¼€å‘æ¨¡å¼ï¼Œç”Ÿæ€å‘å±•å¾—æä¸ºåºå¤§ã€‚`shadcn`æœ¬èº«ä¹Ÿç»è¿‡äº†ä¸€äº›æ¶æ„è°ƒæ•´ï¼Œæ–°å¢äº†ä¸€äº›ç‰¹æ€§ï¼Œæ¯”å¦‚`add`å‘½ä»¤æ”¯æŒç¬¬ä¸‰æ–¹`registry`ä»¥åŠæ”¯æŒ`build`å‘½åç­‰ã€‚æœ¬ç¯‡åœ¨è§£æ`shadcn` CLI çš„åŸºç¡€ä¸Šè¯¦ç»†ä»‹ç»ä¸€ä¸‹å¦‚ä½•åŠ å…¥`shadcn`ç»„ä»¶ç”Ÿæ€ã€‚

<!--truncate-->

## shadcn add

ä¸Šä¸€ç¯‡è®²åˆ°`shadcn add`å‘½ä»¤ä¼šé»˜è®¤ä»`shadcn`æ–‡æ¡£åŒåŸŸçš„åœ°å€è·å–`registry.json`æ–‡ä»¶ï¼Œä»¥è§£æ`shadcn`ç»„ä»¶åº“çš„ç»„ä»¶ç›®å½•ç»“æ„å’Œç»„ä»¶ä»£ç ã€‚å½“æ—¶`shadcn add`å‘½ä»¤åªæ”¯æŒé€šè¿‡å®šä¹‰`process.env.COMPONENTS_REGISTRY_URL`æ¥è‡ªå®šä¹‰`registry.json`çš„åŸŸï¼Œè¿™ç§æ–¹å¼æœ€å¤§çš„å±€é™æ€§å°±æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™åªèƒ½æŒ‡å®šä¸€ä¸ªç¬¬ä¸‰æ–¹åŸŸçš„åœ°å€ï¼Œå½“ä½ è¦ä½¿ç”¨`shadcn add`æ·»åŠ ä¸åŒåŸŸçš„ç»„ä»¶æ—¶ï¼Œå°±è¦ä¸æ–­ä¿®æ”¹`process.env.COMPONENTS_REGISTRY_URL`ã€‚

æ‰€ä»¥`shadcn add`å‘½ä»¤æœ€å¤§çš„æ”¹è¿›å°±æ˜¯æ”¯æŒé€šè¿‡`components`å‚æ•°æ¥æŒ‡å®šè¦æ·»åŠ çš„ç»„ä»¶çš„åœ°å€ï¼Œè¿™æ ·ç¬¬ä¸‰æ–¹ç»„ä»¶å°±èƒ½é€šè¿‡æœ¬åœ°ç¼–å†™`registry.json`è‡ªç”±åœ°å°†è‡ªå·±çš„æŸä¸ªå•ä¸€çš„ç»„ä»¶æˆ–è€…æ•´ä¸ªç»„ä»¶åº“åˆ†äº«å‡ºå»ã€‚

æ”¯æŒè¿™ä¸€ç‰¹æ€§çš„ä»£ç ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œåœ¨`add`å‘½ä»¤æ‰§è¡Œçš„ç¬¬ä¸€æ­¥([æºç ](https://github.com/shadcn-ui/ui/blob/97a8de1c1b2ae590cc9dbe17970a882990c35a59/packages/shadcn/src/commands/add.ts#L90))ä¼šåˆ¤æ–­`components`æ˜¯å¦ä¸ºä¸€ä¸ª`URL`ï¼Œå¦‚æœæ˜¯åˆ™è¯·æ±‚è¯¥`json`å†…å®¹ã€‚

```typescript
const options = addOptionsSchema.parse({
  components,
  cwd: path.resolve(opts.cwd),
  ...opts,
})

let itemType: z.infer<typeof registryItemTypeSchema> | undefined
let registryItem: any = null

if (
  components.length > 0 &&
  // åˆ¤æ–­ add å‘½ä»¤çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦ä¸º url
  (isUrl(components[0]) || isLocalFile(components[0]))
) {
  registryItem = await getRegistryItem(components[0], "")
  itemType = registryItem?.type
}
```

`isUrl`åˆ¤æ–­æ˜¯å¦ä¸ºè¿œç«¯åœ°å€

```typescript
function isUrl(path: string) {
  try {
    new URL(path)
    return true
  } catch (error) {
    return false
  }
}
```

å¦‚æœæ˜¯è¿œç«¯åœ°å€ï¼Œåˆ™`fetch`è¯·æ±‚`json`ï¼Œè·å–`json`å†…å®¹å®šä¹‰çš„ç»„ä»¶æºç ç­‰å†…å®¹ï¼Œåé¢å°±è·Ÿä¸Šä¸€ç¯‡çš„ä»‹ç»çš„æµç¨‹å¤§ä½“ä¸€è‡´ï¼Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚

```typescript
function getRegistryItem(name: string, style: string) {
  try {
    ...
    
    // Handle URLs and component names
    const [result] = await fetchRegistry([
      isUrl(name) ? name : `styles/${style}/${name}.json`,
    ])

    return registryItemSchema.parse(result)
  } catch (error) {
    logger.break()
    handleError(error)
    return null
  }
}
```

## shadcn build

`shadcn build`æ˜¯`shadcn`åœ¨[`2.3.0`](https://github.com/shadcn-ui/ui/commit/cb742e98252fe8aa5cad3377d06e1d8a884953db)ä¸­æ–°å¢çš„å‘½åï¼Œç”¨æ¥æ„å»º`registry.json`æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è®©ä½ çš„ç»„ä»¶åº“æ”¯æŒä½¿ç”¨`shadcn add`å‘½ä»¤æ·»åŠ åˆ°å…¶ä»–é¡¹ç›®å†…éƒ¨ã€‚

`shadcn build`å‘½ä»¤çš„é€»è¾‘éå¸¸ç®€å•ï¼ˆ[æºç ä½ç½®](https://github.com/shadcn-ui/ui/blob/19d7fbb73175ab1ec7db9f8454572625dff3f79f/packages/shadcn/src/commands/build.ts#L18)ï¼‰æ€»ç»“æ¥è¯´å°±åˆ†ä¸º 4 æ­¥ï¼š

![image-20250727160853198](./../public/images/image-20250727160853198.png)

### æŸ¥æ‰¾å¹¶è§£æ registry.json

è¯¥å‘½ä»¤é»˜è®¤ä¼šä»é¡¹ç›®æ ¹ç›®å½•è·å–`registry.json`æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡`registry`å’Œ`cwd`å‚æ•°æ¥æŒ‡å®š`registry.json`æ–‡ä»¶çš„è·¯å¾„ï¼ˆä¸€èˆ¬ç”¨äº`monorepo`é¡¹ç›®ï¼‰ã€‚

```typescript
const options = buildOptionsSchema.parse({
  cwd: path.resolve(opts.cwd),
  registryFile: registry,
  outputDir: opts.output,
})

// æ£€æŸ¥æŒ‡å®šçš„ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿”å›è§£æåçš„æœ¬åœ° registry.json å’Œè¾“å‡ºæ–‡ä»¶ç›®å½•ç»å¯¹è·¯å¾„
const { resolvePaths } = await preFlightBuild(options)
// è¯»å– registry.json
const content = await fs.readFile(resolvePaths.registryFile, "utf-8")

// ä½¿ç”¨ zod æ ¡éªŒ registry.json çš„ç»“æ„æ˜¯å¦ç¬¦åˆ registry schema ç»“æ„
// https://ui.shadcn.com/schema/registry-item.json
const result = registrySchema.safeParse(JSON.parse(content))

if (!result.success) {
  logger.error(
    `Invalid registry file found at ${highlighter.info(
      resolvePaths.registryFile
    )}.`
  )
  process.exit(1)
}
```

è¯¥å‘½åä½¿ç”¨`zod`è¿›è¡Œ`registry.json`ç»“æ„çš„æ ¡éªŒï¼Œåˆ¤æ–­å…¶æ˜¯å¦ç¬¦åˆ`shadcn`çº¦æŸçš„å®šä¹‰ç»“æ„ã€‚`shadcn`å®˜æ–¹å¯¹äº`registry.json`çš„çº¦æŸï¼Œå¯ä»¥åœ¨`shadcn`çš„æ–‡æ¡£ä¸­æŸ¥çœ‹â€”â€”[`registry.json`](https://ui.shadcn.com/docs/registry/registry-json)ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ã€‚

### éå†æ–‡ä»¶è·¯å¾„

æ ¹æ®`registry.json`ä¸­æ³¨å†Œçš„`items`å­—æ®µï¼Œå¯ä»¥æ‰¾åˆ°å®šä¹‰é¡¹ç›®å†…éƒ¨ç»„ä»¶çš„æ–‡ä»¶è·¯å¾„å­—æ®µ`files`ï¼Œè¿™äº›åœ¨`shadcn`çš„æ–‡æ¡£ä¸­éƒ½æœ‰è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒè¿™é‡Œ[`registry-item.json`](https://ui.shadcn.com/docs/registry/registry-item-json)

```typescript
for (const registryItem of registry.items) {
  ...
}
```

### è¯»å–ç»„ä»¶ä»£ç å¹¶å†™å…¥åˆ°`registry.json`ä¸­

`shadcn build`è¿™ä¸ªå‘½ä»¤ä¸»è¦å°±æ˜¯ä¸ºäº†å°†ç»„ä»¶æºç å†™å…¥åˆ°`registry.json`ä¸­ï¼Œä»è€Œä½¿å¾—ç¬¬ä¸‰æ–¹å¼€å‘è€…åœ¨ä¸ºè‡ªå·±çš„ç»„ä»¶åº“ç¼–å†™`registry.json`æ—¶æ— éœ€å°†ç»„ä»¶æºç å†™å…¥`registry.json`ï¼Œé¿å…ç¹ççš„æµç¨‹ã€‚

```typescript
for (const registryItem of result.data.items) {
  if (!registryItem.files) {
    continue
  }

  for (const file of registryItem.files) {
    file["content"] = await fs.readFile(
      path.resolve(resolvePaths.cwd, file.path),
      "utf-8"
    )
  }
}
```

### å°†registry.jsonå†™å…¥è¾“å‡ºç›®å½•

`build`å‘½ä»¤æœ€åé»˜è®¤å°†`registry.json`å†…å®¹å†™å…¥åˆ°é¡¹ç›®æ ¹ç›®å½•çš„`public`ç›®å½•ä¸‹ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸»è¦æ˜¯å› ä¸ºç°åœ¨å¤§éƒ¨åˆ†çš„ç»„ä»¶å¼€å‘æ¡†æ¶éƒ½ä¼šå°†`public`ç›®å½•åšä¸ºé»˜è®¤çš„é™æ€ä¸ç¼–è¯‘æ–‡ä»¶ç›®å½•ï¼Œåœ¨é¡¹ç›®æ‰“åŒ…çš„æ—¶å€™æ”¯æŒæ‹·è´ç›®å½•å†…éƒ¨çš„æ–‡ä»¶åˆ°æ‰“åŒ…ç›®å½•ä¸‹ã€‚å¦‚æœä¸€ä¸ªç»„ä»¶åº“ä¼šå‘å¸ƒæ–‡æ¡£ç½‘ç«™ï¼Œé‚£ä¹ˆ`registry.json`å°±å¯ä»¥ç›´æ¥åœ¨æ–‡æ¡£ç½‘ç«™çš„åŸŸå†…è®¿é—®åˆ°ï¼Œä¹Ÿä¸ç”¨ä¸º`registry.json`å†å•ç‹¬æŠ˜å å…¶ä»–åŸŸååœ°å€äº†ã€‚

å½“ç„¶`build`å‘½ä»¤ä¹Ÿæ”¯æŒä½¿ç”¨`output`å‚æ•°ä¿®æ”¹`registry.json`å†™å…¥çš„ç›®å½•è·¯å¾„ã€‚

```typescript
await fs.writeFile(
  path.resolve(resolvePaths.outputDir, `${registry.name}.json`),
  JSON.stringify(result.data, null, 2)
)
```

## åŠ å…¥shadcnç”Ÿæ€

å¦‚æœä½ æƒ³ç¼–å†™ä¸€ä¸ªç»„ä»¶æˆ–è€…ç»„ä»¶åº“ï¼Œè®©å…¶æ”¯æŒ`shadcn`çš„ç”Ÿæ€ï¼Œèƒ½å¤Ÿä½¿ç”¨`shadcn add`å‘½ä»¤åœ¨å„ä¸ªé¡¹ç›®ä¹‹é—´å…±äº«ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯åŸºäº`shadcn`æä¾›çš„[`nextjs`æ¨¡æ¿é¡¹ç›®](https://github.com/shadcn-ui/registry-template-v4)ç›´æ¥å¼€å‘ã€‚

ä½ å¯ä»¥ç›´æ¥åœ¨ GitHub ä¸ŠåŸºäºè¿™ä¸ªæ¨¡æ¿é¡¹ç›®åˆ›å»ºä»“åº“å¹¶å…‹éš†åˆ°æœ¬åœ°ç›´æ¥å¼€å§‹å¼€å‘ä½ çš„ç»„ä»¶ï¼Œè¿™ä¸ªé¡¹ç›®çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

```shell
â”œâ”€â”€ ğŸ“„ README.md
â””â”€â”€ ğŸ“‚ app/                          // nextjs çš„è·¯ç”±æ–‡ä»¶ï¼Œç”¨æ¥ç¼–å†™ç»„ä»¶å¼€å‘æ–‡æ¡£
â”‚  â”œâ”€â”€ ğŸ“„ favicon.ico
â”‚  â”œâ”€â”€ ğŸ“„ globals.css
â”‚  â”œâ”€â”€ ğŸ“„ layout.tsx
â”‚  â”œâ”€â”€ ğŸ“„ page.tsx
â””â”€â”€ ğŸ“‚ components/                   // ç¬¬ä¸‰æ–¹é€šç”¨ç»„ä»¶ï¼Œä½¿ç”¨ shadcn add æ·»åŠ å…¶ä»–ç¬¬ä¸‰æ–¹ç»„ä»¶è¾…åŠ©å¼€å‘
â”œâ”€â”€ ğŸ“„ components.json
â”‚  â”œâ”€â”€ ğŸ“„ open-in-v0-button.tsx
â””â”€â”€ ğŸ“‚ lib/
â”‚  â”œâ”€â”€ ğŸ“„ utils.ts
â””â”€â”€ ğŸ“‚ public/                        // è¾“å‡ºç»„ä»¶æ³¨å†Œçš„ registry.json æ–‡ä»¶ï¼Œæ„å»ºæ–‡æ¡£çš„æ—¶å€™ä¼šç›´æ¥æ‹·è´
â”‚  â””â”€â”€ ğŸ“‚ r/
â”‚    â”œâ”€â”€ ğŸ“„ hello-world.json
â””â”€â”€ ğŸ“‚ registry/                      // ç»„ä»¶å­˜æ”¾ç›®å½•
â”‚  â””â”€â”€ ğŸ“‚ new-york/
â”‚    â””â”€â”€ ğŸ“‚ blocks/                   // å—çº§å¤æ‚ç»„ä»¶
â”‚      â””â”€â”€ ğŸ“‚ hello-world/
â”‚        â”œâ”€â”€ ğŸ“„ hello-world.tsx
â”‚    â””â”€â”€ ğŸ“‚ ui/                       // å•ä¸ªç»„ä»¶
â”‚      â”œâ”€â”€ ğŸ“„ button.tsx
â””â”€â”€ ğŸ“„ tsconfig.json
â”œâ”€â”€ ğŸ“„ registry.json                   // æ³¨å†Œç»„ä»¶ï¼Œå¿…é¡»è‡ªå·±ç¼–å†™
```

å½“ä½ åœ¨ç¼–å†™å®Œç»„ä»¶`push`åˆ° GitHub åï¼Œå¯ä»¥ç›´æ¥åœ¨ Vercel ä¸Šç»‘å®šä½ çš„ä»“åº“å¹¶æ„å»ºå‘å¸ƒã€‚

ç„¶ååˆ«äººå°±èƒ½é€šè¿‡ Vercel ç»™ä½ åˆ†é…çš„åŸŸååœ°å€æˆ–è€…ä½ è‡ªå®šä¹‰çš„åŸŸååœ°å€è®¿é—®åˆ°ä½ å¼€å‘çš„ç»„ä»¶çš„`registry.json`ï¼Œå¹¶ä¸”ä½¿ç”¨`shadcn add`å‘½ä»¤æ·»åŠ ä½ å¼€å‘çš„ç»„ä»¶åˆ°æœ¬åœ°ã€‚

åŸºäº`shadcn`è¿™å¥—æµç¨‹æœ€å¤§çš„ä¾¿æ·ä¹‹å¤„å°±æ˜¯ä½ æ— éœ€å»é€‰æ‹©å·¥å…·æ‰“åŒ…ä½ çš„ç»„ä»¶åº“ï¼Œä½ åªéœ€è¦ç¼–å†™å¥½ç»„ä»¶çš„`registry.json`å³å¯ã€‚

## å‚è€ƒé¡¹ç›®

[æ­Œè¯ç»„ä»¶ä»“åº“](https://github.com/wood3n/shadcn-lyrics)

ä½¿ç”¨ Vercel å¯¼å…¥é¡¹ç›®å¹¶ä¸€é”®éƒ¨ç½²ï¼Œç°åœ¨å°±å¯ä»¥ä½¿ç”¨è®¿é—®[æˆ‘çš„æ­Œè¯ç»„ä»¶çš„`registry.json`æ–‡ä»¶](https://shadcn-lyrics.vercel.app/r/lyrics.json)äº†ï¼Œå¹¶ä¸”æ”¯æŒåœ¨é¡¹ç›®ä¸­ä½¿ç”¨`shadcn add https://shadcn-lyrics.vercel.app/r/lyrics.json`æ¥æ·»åŠ ç»„ä»¶ã€‚

![image-20250727215325524](./../public/images/image-20250727215325524.png)
